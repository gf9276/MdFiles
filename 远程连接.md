<!-- TOC -->

- [1. 远程连接.md](#1-远程连接md)
- [2. windows自带的远程桌面连接ubuntu](#2-windows自带的远程桌面连接ubuntu)
  - [2.1. ubuntu安装xrdp](#21-ubuntu安装xrdp)
  - [2.2. 换一下监听端口](#22-换一下监听端口)
  - [2.3. 重启服务](#23-重启服务)
  - [2.4. 设置一下登录信息](#24-设置一下登录信息)
  - [2.5. windows远程连接](#25-windows远程连接)
  - [2.6. 解锁丝滑控制](#26-解锁丝滑控制)
    - [2.6.1. 解锁60帧](#261-解锁60帧)
    - [2.6.2. 开启显卡加速以及 H264 编码](#262-开启显卡加速以及-h264-编码)
    - [2.6.3. 带宽+色彩](#263-带宽色彩)
- [3. windows terminal 远程连接服务器](#3-windows-terminal-远程连接服务器)
- [4. pycharm](#4-pycharm)

<!-- /TOC -->


# 1. 远程连接.md

就是连接服务器啦，包括远程桌面在内


# 2. windows自带的远程桌面连接ubuntu

## 2.1. ubuntu安装xrdp

```
apt update
```
```
apt -y install tightvncserver xrdp
```

## 2.2. 换一下监听端口

3389不安全，而且如果是wsl，3389会和windows打起来

下面这条指令就是把`/etc/xrdp/xrdp.ini`文件中的3389替换成3390

```
sed -i 's/3389/3390/g' /etc/xrdp/xrdp.ini
```

## 2.3. 重启服务

```
systemctl restart xrdp
```

## 2.4. 设置一下登录信息

为什么要写这个？如果不写这个，想要远程控制ubuntu，你就得提前logout被控端，麻烦的（注意，这里和wsl里面有点不同）

直接在下面文件里写入信息（注意切回普通用户）
```
vim ~/.xsessionrc
```
内容如下
```
export GNOME_SHELL_SESSION_MODE=ubuntu
export XDG_CURRENT_DESKTOP=ubuntu:GNOME
export XDG_CONFIG_DIRS=/etc/xdg/xdg-ubuntu:/etc/xdg
```

**设置断开连接自动关闭桌面会话**

防止断开连接但是没有注销界面导致一堆bug

```
sudo vim /etc/xrdp/sesman.ini
```

![](https://cdn.jsdelivr.net/gh/gf9276/image/远程连接/20230905141409.png)

## 2.5. windows远程连接

用自带的就行了

正常来讲设置了`~/.xsessionrc`不会黑屏，如果黑屏的话，把桌面ubuntu **logout** ！！！


## 2.6. 解锁丝滑控制

windows 端的远程桌面连接，经过设置是可以更加丝滑的，理论上来讲，windows控制Ubuntu，帧率至少30，我体验下来可能有40（ubuntu22.04+gnome4的效果比ubuntu20.04+gnome3/KDE要好）。不过这也就是极限了，没办法，开源的xrdp差点意思。

### 2.6.1. 解锁60帧

默认是30帧的，[参考这个官方链接](https://learn.microsoft.com/zh-cn/troubleshoot/windows-server/remote/frame-rate-limited-to-30-fps)解锁60帧。

注意，这里要修改注册表，小心操作。

### 2.6.2. 开启显卡加速以及 H264 编码

按照这个[链接](https://zhuanlan.zhihu.com/p/492662854)，打开`编辑组策略`把里面显卡加速的两个东西打开就行，这个感觉主要是被控制端要打开，如果你是控制端，这个好像没啥用。

### 2.6.3. 带宽+色彩

如果你网够好（内网网线连接，或者像wsl这样虚拟10G网卡），直接按照下面这样子设置最大值，获得最佳体验。

![](https://cdn.jsdelivr.net/gh/gf9276/image/远程连接/02.png)

![](https://cdn.jsdelivr.net/gh/gf9276/image/远程连接/03.png)



# 3. windows terminal 远程连接服务器

为了方便通过windows terminal直接打开远程连接，对配置文件进行修改

直接打开terminal的配置文件，加入如下图的代码：

![](https://cdn.jsdelivr.net/gh/gf9276/image/远程连接/20221109193555.png)

```
            {
                "colorScheme": "Ubuntu-22.04-ColorScheme",
                "cursorShape": "bar",
                "font": 
                {
                    "face": "agave Nerd Font Mono r"
                },
                "guid": "{FE8EE342-1361-7980-41BE-A44462E516FC}",
                "hidden": false,
                "name": "实验室1080ti",
                "commandline": "ssh guof@10.68.77.68",
                "useAcrylic": true,
                "icon" : "ms-appx:///ProfileIcons/{9acb9455-ca41-5af7-950f-6bca1bc9722f}.png"
            }
```

即可

# 4. pycharm

TODO